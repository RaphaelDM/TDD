### Exercice MOCK-3 : Système de Paiement (Intermédiaire+)
**Objectif** : Mocker des API de paiement et tester les transactions

#### Description
Implémentez un système de paiement avec plusieurs providers et gestion des webhooks.

#### Architecture
- `PaymentService` : orchestrateur principal
- `StripeAdapter` : adapter pour Stripe
- `PayPalAdapter` : adapter pour PayPal
- `BankTransferAdapter` : adapter pour virement bancaire
- `PaymentGateway` : sélectionne le bon adapter
- `TransactionRepository` : persistance
- `FraudDetectionService` : détection de fraude
- `NotificationService` : notifications client
- `WebhookHandler` : gestion des callbacks

#### Fonctionnalités
1. Créer une transaction
2. Autoriser un paiement
3. Capturer un paiement
4. Rembourser (total ou partiel)
5. Annuler une transaction
6. Vérifier le statut
7. Gérer les webhooks
8. Détecter les fraudes
9. Gérer les devises multiples
10. Retry automatique sur échec temporaire

#### Scénarios à tester avec mocks (minimum 25)
- Paiement réussi avec chaque provider
- Paiement refusé (fonds insuffisants)
- Paiement échoué (erreur technique)
- Détection de fraude bloque le paiement
- Remboursement réussi
- Remboursement partiel
- Gestion des webhooks (paiement confirmé, échoué)
- Timeout lors du paiement
- Retry sur erreur temporaire
- Conversion de devises
- Transaction sauvegardée correctement
- Notifications envoyées au client
- Gestion des doublons (idempotence)
- Tests avec tous les providers mockés
- Comportement du fallback provider

#### Mocks complexes
- Mock des API de paiement (Stripe, PayPal)
- Mock du service anti-fraude avec scoring
- Mock du repository (base de données)
- Mock des webhooks entrants
- Mock du service de conversion de devises
- Simulation de latence réseau
- Simulation d'erreurs intermittentes

#### Challenges
- Tester l'idempotence (même requête = même résultat)
- Vérifier les transactions atomiques
- Tester les rollbacks en cas d'erreur
- Utiliser des fixtures pour les données de paiement